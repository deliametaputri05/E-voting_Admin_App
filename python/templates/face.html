<!-- Store this code in 'login.html' file inside the 'templates' folder -->
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Face Set Up</title>
    <link
      href="https://fonts.googleapis.com/css?family=Heebo:400,700|IBM+Plex+Sans:600"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='dist/css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
      integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
      crossorigin="anonymous"
    />
  </head>

  <body class="is-boxed has-animations">
    <div class="body-wrap boxed-container">
      <header class="site-header">
        <div class="container">
          <div class="site-header-inner">
            <div class="brand header-brand">
              <h1 class="m-0">
                <a href="home">
                  <img
                    class="header-logo-image asset-light"
                    src="{{ url_for('static', filename='dist/images/LogoDinasPangan.png') }}"
                    alt="Logo"
                    width="32"
                    height="32"
                  />
                  <img
                    class="header-logo-image asset-dark"
                    src="{{ url_for('static', filename='dist/images/LogoDinasPangan.png') }}"
                    alt="Logo"
                    width="32"
                    height="32"
                  />
                </a>
              </h1>
            </div>
          </div>
        </div>
      </header>
      <main>
        <section>
          <div class="container">
            <div class="hero-inner">
              <div class="hero-copy">
                <h1 class="hero-title mt-0">Face Set Up</h1>
                <div style="height: auto">
                  {%if message == 1%}
                  <p class="text-danger">Foto tidak Jelas</p>
                  {%endif%}
                  <canvas id="canvas" style="position: absolute"> </canvas>
                  <video id="player" style="width: 100%" autoplay></video>
                  <br />
                  <br />
                  <button
                    id="capture"
                    class="button button-primary btn-block"
                    onclick="capture()"
                  >
                    Capture
                  </button>
                  <a
                    class="button button-success btn-block"
                    href="{{url_for('home')}}"
                    role="button"
                    >Back to Home
                  </a>
                  <form
                    action="/facesetup"
                    method="post"
                    id="formss"
                    style="margin-top: 250px"
                    enctype="multipart/form-data"
                  >
                    <input
                      type="text"
                      id="pic"
                      name="pic"
                      style="display: none"
                    />

                    <button id="scan" class="btn btn-primary">Register</button>
                  </form>
                </div>
              </div>
              <div class="hero-media">
                <div class="header-illustration">
                  <img
                    class="header-illustration-image asset-light"
                    src="{{ url_for('static', filename='dist/images/header-illustration-light.svg') }}"
                    alt="Header illustration"
                  />
                  <img
                    class="header-illustration-image asset-dark"
                    src="{{ url_for('static', filename='dist/images/header-illustration-dark.svg') }}"
                    alt="Header illustration"
                  />
                </div>
                <div class="hero-media-illustration">
                  <img
                    class="hero-media-illustration-image asset-light"
                    src="{{ url_for('static', filename='dist/images/hero-media-illustration-light.svg') }}"
                    alt="Hero media illustration"
                  />
                  <img
                    class="hero-media-illustration-image asset-dark"
                    src="{{ url_for('static', filename='dist/images/hero-media-illustration-dark.svg') }}"
                    alt="Hero media illustration"
                  />
                </div>
                <div class="hero-media-container">
                  <img
                    class="hero-media-image asset-light"
                    src="{{ url_for('static', filename='dist/images/github.png') }}"
                    alt="Hero media"
                    width="538"
                    height="380"
                  />
                  <img
                    class="hero-media-image asset-dark"
                    src="{{ url_for('static', filename='dist/images/github-dark.png') }}"
                    alt="Hero media"
                    width="538"
                    height="380"
                  />
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="features section">
          <div class="container">
            <div class="features-inner section-inner has-bottom-divider">
              <div class="features-header text-center">
                <div class="container-sm">
                  <div class="features-image"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
    <script src="https://unpkg.com/scrollreveal@4.0.0/dist/scrollreveal.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
      crossorigin="anonymous"
    ></script>
    <script src="{{ url_for('static', filename='dist/js/main.min.js') }}"></script>
    <script>
      const player = document.getElementById("player");
      const canvas = document.getElementById("canvas");
      const context = canvas.getContext("2d");
      const captureButton = document.getElementById("capture");
      const scan = document.getElementById("scan");
      const img = document.getElementById("pic");
      const form = document.getElementById("formss");
      const back = document.getElementById("backtlg");

      const vgaconstraints = {
        video: true,
        video: { width: { exact: 640 }, height: { exact: 480 } },
      };
      const video = document.querySelector("video");
      function capture() {
        canvas.style.width = "500";
        canvas.style.height = "500";

        context.drawImage(player, 0, 0, canvas.width, canvas.height);
        player.style.display = "none";
        captureButton.style.display = "none";
        scan.style.display = "";
        form.style.display = "";
        back.style.display = "none";

        cap = canvas.toDataURL("image/png").split(",")[1];
        img.value = cap;
      }

      function stop() {
        player.srcObject.getVideoTracks().forEach((track) => track.stop());
      }

      navigator.mediaDevices.getUserMedia(vgaconstraints).then((stream) => {
        // Attach the video stream to the video element and autoplay.
        // player.srcObject = stream;
        video.srcObject = stream;
      });
    </script>
  </body>
</html>
